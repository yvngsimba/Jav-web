<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Advanced Functions">
  <title>(2) New Messages</title>
</head>
<body>

  <button class="js-button">Start</button>
  
  <br>
  <br>

  <button class="js-button2">Add to cart</button>

  <p></p>

  <br>
  <br>

  <button class="js-add">Add</button>
  
  <button class="js-sub" onclick="
    num--;
    titleChange();
  ">Remove</button>
  
  <script>
    /* 12a. , 12b. 
    const add = function() {
      console.log(2+3);
    }

    function runTwice(fun) {
      fun();
      fun();
    }

    runTwice(function(){
      console.log('12b');
    });

    runTwice(add);
    */

    // 12c. , 12d.
    document.querySelector('.js-button')
      .addEventListener('click', () => {
        const button = document.querySelector('.js-button');

        button.innerHTML = 'Loading...';

        setTimeout(() => {
          button.innerHTML = 'Finished!';
        }, 1000);
      });
    //  12c. , 12d.
    
    // 12e.

    let refresh;
    function addedText(){
      const text = document.querySelector('p');
      
      if (refresh) {
        clearTimeout(refresh);
      } 

      text.innerHTML = 'Added';

      refresh = setTimeout(() => {
        text.innerHTML = '';
      }, 2000);
    }

    document.querySelector('.js-button2') 
      .addEventListener('click', () =>{
        addedText();
      });
    
    // 12e.

    // 12g. 12h. 12i.
    const title = document.querySelector('title');
    let num = 2;

    function titleChange() {

      let isApp = false;
      

      if (num < 0 ) {
        num = 0;
      } else {
        const intervalId = setInterval(() => {
            if (isApp) {
              title.innerHTML = 'App';
            } else {
                title.innerHTML = `(${num}) New Messages`;
            } 
          isApp = !isApp;

          if (num === 0) {
            clearInterval(intervalId);
            title.innerHTML = 'App';
          }
        }, 1000);
      }
    }
    titleChange();

    document.querySelector('js-add')
      .addEventListener('click', () => {
        const title = document.querySelector('js-add');
        if (num === 0) {
            clearInterval(intervalId);
            title.innerHTML = 'App';
          }
        }, 1000);
      
  </script>
</body>
</html>